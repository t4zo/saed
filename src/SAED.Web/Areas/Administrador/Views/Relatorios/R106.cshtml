@model R106ViewModel

@{
    ViewData["Title"] = "105 - Consolidado por Aluno";
}

<main class="uk-card uk-card-default uk-padding-small">
    <h2 class="uk-card-header uk-border-rounded uk-text-center uk-margin-bottom">Consolidado por Aluno</h2>
    <section class="uk-flex">
        <dl class="uk-description-list uk-description-list-divider uk-margin-top uk-margin-small-right">
            <dt>Total de Questões</dt>
            <dd class="uk-text-center">@Model.QtdTotalQuestoes</dd>
        </dl>
        @foreach (var disciplina in Model.DisciplinasViewModel.Distinct())
        {
            <dl class="uk-description-list uk-margin-small-right uk-margin-small-left">
                <dt>@disciplina.Disciplina.Nome</dt>
                <dd class="uk-text-capitalize uk-text-center">@disciplina.QtdQuestoesDisciplina</dd>
            </dl>
        }
    </section>
    @foreach (var escola in Model.AlunosViewModel.Select(x => x.Escola).Distinct())
    {
        @foreach (var etapa in Model.AlunosViewModel.Select(x => x.Etapa).Distinct())
        {
            <h5>@escola.Nome - @etapa.Nome</h5>
            <table id="table_id" class="uk-table uk-table-hover uk-text-center uk-table-striped">
                <thead>
                <tr>
                    <th class="uk-text-center">Aluno</th>
                    @foreach (var disciplina in Model.DisciplinasViewModel.Select(x => x.Disciplina).Distinct())
                    {
                        <th class="uk-text-center">@disciplina.Nome</th>
                    }
                </tr>
                </thead>
                <tbody>
                @foreach (var escolaEtapaAlunoViewModel in Model.AlunosViewModel.Distinct())
                {
                    <tr>
                        <td>@escolaEtapaAlunoViewModel.Aluno.Nome</td>

                        @foreach (var resultado in Model.ResultadoAlunosViewModel)
                        {
                            if (escolaEtapaAlunoViewModel.Escola.Id == resultado.AlunoViewModel.Escola.Id &&
                                escolaEtapaAlunoViewModel.Etapa.Id == resultado.AlunoViewModel.Etapa.Id &&
                                escolaEtapaAlunoViewModel.Aluno.Id == resultado.AlunoViewModel.Aluno.Id &&
                                resultado.DisciplinaViewModel.Disciplina.Id == resultado.AlunoViewModel.DisciplinaId &&
                                resultado.AlunoViewModel.Escola.Id == resultado.DisciplinaViewModel.EscolaId &&
                                resultado.AlunoViewModel.Aluno.Id == resultado.DisciplinaViewModel.AlunoId)
                            {
                                <td>@resultado.TaxaAcerto%</td>
                            }
                        }
                    </tr>
                }
                </tbody>
            </table>
        }
    }
</main>